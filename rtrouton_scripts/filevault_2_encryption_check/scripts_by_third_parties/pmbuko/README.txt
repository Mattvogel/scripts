This script was written and contributed by Peter Bukowinski (http://yourmacguy.wordpress.com/).
It has the same detection reporting as my script does for Mac OS X 10.7.x, but is more sophisticated in identifying and processing the various states.

